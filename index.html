<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Glasstire DataHack</title>
		<meta charset="utf-8"/>
		<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" />
        <meta content="Ronal Infante" name="author" />
        <meta content="Glasstire DataHack" name="description" />
		<link href="style.css" rel="stylesheet"/>
	    <script src="three.min.js"></script>
	</head>
	<body>
        <div id="dataVis"></div>
        <section style="margin: 300px auto; width: 800px;"><iframe src="https://docs.google.com/presentation/d/e/2PACX-1vT7S7GzsbAGHmlgN93MJZ8QRuH2MIoMKBiny34hw7LaYQSet9j3ihQmTZ9RRoGtX6aW-r2nRXpKA4cd/embed?start=false&loop=false&delayms=3000" frameborder="0" width="960" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe></section>

        <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
        <script>function createTextCanvas(e,t,n,a){a=a||16;var r=document.createElement("canvas"),i=r.getContext("2d"),o=a+"px "+(n||"Arial");i.font=o;var d=i.measureText(e).width,s=Math.ceil(a);return r.width=d,r.height=s,i.font=o,i.fillStyle=t||"black",i.fillText(e,0,Math.ceil(.8*a)),r}function createText2D(e,t,n,a,r,i){var o=createTextCanvas(e,t,n,a),d=new THREE.PlaneGeometry(o.width,o.height,r,i),s=new THREE.Texture(o);s.needsUpdate=!0;var c=new THREE.MeshBasicMaterial({map:s,color:16777215,transparent:!0}),l=new THREE.Mesh(d,c);return l.scale.set(.5,.5,.5),l.doubleSided=!0,l}function hexToRgb(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}var renderer=new THREE.WebGLRenderer({antialias:!0});renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),document.getElementById("dataVis").prepend(renderer.domElement),renderer.setClearColor(new THREE.Color(16777215));var camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e4);camera.position.set(100,-100,300);var scene=new THREE.Scene,scatterPlot=new THREE.Object3D;function v(e,t,n){return new THREE.Vector3(e,t,n)}scene.add(scatterPlot),scatterPlot.rotation.y=0;var dataset=[],format=d3.format("+.3f"),data=d3.csv("defaultData.csv",function(e){e.forEach(function(e,t){dataset[t]={x:+e.x,y:+e.y,z:+e.z}});var t,n,a=d3.extent(dataset,function(e){return e.x}),r=d3.extent(dataset,function(e){return e.y}),i=d3.extent(dataset,function(e){return e.z}),o={xMax:a[1],xCen:(a[1]+a[0])/2,xMin:a[0],yMax:r[1],yCen:(r[1]+r[0])/2,yMin:r[0],zMax:i[1],zCen:(i[1]+i[0])/2,zMin:i[0]},d=(d3.scale.category20c(),d3.scale.linear().domain(a).range([-50,50])),s=d3.scale.linear().domain(r).range([-50,50]),c=d3.scale.linear().domain(i).range([100,-100]);(t=createText2D(Math.floor(format(a[0])))).position.x=d(o.xMin),t.position.y=s(o.yMin)-20,scatterPlot.add(t),(t=createText2D(Math.floor(format(a[1])))).position.x=d(o.xMax),t.position.y=s(o.yMin)-20,scatterPlot.add(t),(n=createText2D(Math.floor(format(r[0])))).position.x=d(o.xMin)-20,n.position.y=s(o.yMin),scatterPlot.add(n),(n=createText2D(Math.floor(format(r[1])))).position.x=d(o.xMin)-20,n.position.y=s(o.yMax)+5,scatterPlot.add(n);var l=geometry=new THREE.Geometry;l.vertices.push(new THREE.Vector3(d(o.xMin)-10,s(o.yMin)-10,0)),l.vertices.push(new THREE.Vector3(d(o.xMin)-10,d(o.xMax),0));var w=geometry=new THREE.Geometry;w.vertices.push(new THREE.Vector3(d(o.xMin)-10,d(o.xMin)-10,0)),w.vertices.push(new THREE.Vector3(d(o.xMax),d(o.xMin)-10,0));var E=new THREE.LineBasicMaterial({color:0,linewidth:5}),x=new THREE.Line(w,E),u=new THREE.Line(l,E);scatterPlot.add(x),scatterPlot.add(u);for(var m=new THREE.PointsMaterial({vertexColors:!0,size:5}),f=dataset.length,v=new THREE.Geometry,h=0;h<f;h++){var T=d(dataset[h].x),M=s(dataset[h].y),p=c(dataset[h].z);v.vertices.push(new THREE.Vector3(T,M,p)),v.colors.push((new THREE.Color).setRGB((146+39*h/f)/255,(224+-49*h/f)/255,(255+0*h/f)/255))}var y=new THREE.Points(v,m);scatterPlot.add(y),renderer.render(scene,camera);var R=!1,H=((new Date).getTime(),!1),g=0,P=0;window.onmousedown=function(e){H=!0,g=e.clientX,P=e.clientY},window.onmouseup=function(){H=!1},window.onmousemove=function(e){if(H){var t=e.clientX-g,n=e.clientY-P;scatterPlot.rotation.y+=.01*t,camera.position.y+=n,g+=t,P+=n}};var z=!1;window.ondblclick=function(){z=!z},function e(t){if(!R){if(z){for(var n=v.vertices,a=0;a<n.length;a++){var r=n[a];console.log(r),r.angle+=.01*r.speed,r.x=Math.cos(r.angle)*r.radius,r.z=Math.sin(r.angle)*r.radius}v.__dirtyVertices=!0}renderer.clear(),camera.lookAt(scene.position),renderer.render(scene,camera)}window.requestAnimationFrame(e,renderer.domElement)}((new Date).getTime()),onmessage=function(e){R="pause"==e.data}});window.addEventListener("resize",function(e){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)});</script>

	</body>
</html>